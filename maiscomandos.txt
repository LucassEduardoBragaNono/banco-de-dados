###FUNCAO AGREGADA - AGRUPAMENTO

SUM(PARAM) - NUMERICO - SOMA VALORES
AVG(PARAM) - NUMERICO - MEDIA ARITMETICA
COUNT(PARAM) - ID - CONTADOR DE REGISTRO
MAX(PARAM) - MAIOR ELEMENTO DE UM GRUPO 
MIN(PARAM) - MENOR ELEMENTO DE UM GRUPO

DAY() - dia de um campo DATE
MONTH() - mes de um campo DATE
YEAR() - ano de um campo DATE
BETWEEN - entre
IN()
##EX1 - CALCULAR QUANTOS MÉDICOS A CLÍNICA TEM CADASTRADO

SELECT COUNT(id_medico) "Numero de medicos cadastrados"
FROM medicos
WHERE sexo = "F" AND YEAR(data_nasc) > 1990

##ex2 - contar quantos atendimentos foram realizados na linic
SELECT COUNT(*)"Num de atendimentos"
FROM atendimentos
WHERE data_a BETWEEN "2024-08-01" AND "2024-08-10"
AND id_medico IN (3,4,5)

##ex3 - calcular a media das idades entre todos os medicos

SELECT FORMAT(AVG(YEAR(CURRENT_DATE()) - YEAR(data_nasc)),2) "Média das idades dos médicos"
FROM medicos

##ex4 - calcular a media de exames cadastrados 

SELECT CONCAT("R$",FORMAT(AVG(valor),2,"de_DE")) "Média dos valores de exames"
FROM exames

SELECT SUM(valor), COUNT(valor), SUM(valor)/COUNT(valor)
FROM exames ##verificar

##ex5 - calcular a receita da clinica dos atendimentos considerando o valor da consulta padrao 250 reais

SELECT CONCAT("R$", FORMAT(COUNT(id_atendimento) * 250, 2)) "Receita da clínica"
FROM atendimentos

#ex6 achar o examas com maior valor
SELECT MAX(valor)
FROM exames

#ex7 achar o exame com menor valor

SELECT MIN(valor)
FROM exames

#ex8 achar o exame com o maior e menor valor
SELECT MAX(valor) "maior", MIN(valor) "menor"
FROM exames

## ex1 - Contar o numero de alunos do sexo masculino faculdade
SELECT	COUNT(id_aluno) "Quantidade TOTAL de alunos: "
FROM alunos
WHERE sexo = "M"

##ex2 - calcular a receita da faculdade. a receita da faculdade é a soma dos valores de todas as disciplinas que estao sendo cursadas
SELECT CONCAT("R$",FORMAT(SUM(valor), 2,"de_de")) "Receita"
FROM disciplinas d INNER JOIN matriculas m
ON(d.id_disciplina=m.id_disciplina)

##ex3 - calcular a receita de cada curso da faculdade
SELECT c.id_curso "Código",
	c.descritivo "Descritivo" ,
	SUM(d.valor) "Valor"
FROM disciplinas d INNER JOIN matriculas m
ON (d.id_disciplina=m.id_disciplina)
INNER JOIN cursos c ON(c.id_curso=d.id_curso) #sempre agrupar por ID
GROUP BY c.id_curso
ORDER BY SUM(d.valor) DESC
LIMIT 1