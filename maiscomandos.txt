###FUNCAO AGREGADA - AGRUPAMENTO

SUM(PARAM) - NUMERICO - SOMA VALORES
AVG(PARAM) - NUMERICO - MEDIA ARITMETICA
COUNT(PARAM) - ID - CONTADOR DE REGISTRO
MAX(PARAM) - MAIOR ELEMENTO DE UM GRUPO 
MIN(PARAM) - MENOR ELEMENTO DE UM GRUPO

DAY() - dia de um campo DATE
MONTH() - mes de um campo DATE
YEAR() - ano de um campo DATE
BETWEEN - entre
IN()
##EX1 - CALCULAR QUANTOS MÉDICOS A CLÍNICA TEM CADASTRADO

SELECT COUNT(id_medico) "Numero de medicos cadastrados"
FROM medicos
WHERE sexo = "F" AND YEAR(data_nasc) > 1990

##ex2 - contar quantos atendimentos foram realizados na linic
SELECT COUNT(*)"Num de atendimentos"
FROM atendimentos
WHERE data_a BETWEEN "2024-08-01" AND "2024-08-10"
AND id_medico IN (3,4,5)

##ex3 - calcular a media das idades entre todos os medicos

SELECT FORMAT(AVG(YEAR(CURRENT_DATE()) - YEAR(data_nasc)),2) "Média das idades dos médicos"
FROM medicos

##ex4 - calcular a media de exames cadastrados 

SELECT CONCAT("R$",FORMAT(AVG(valor),2,"de_DE")) "Média dos valores de exames"
FROM exames

SELECT SUM(valor), COUNT(valor), SUM(valor)/COUNT(valor)
FROM exames ##verificar

#ex4 - calcular a mensalidade que cada aluno paga pelas disciplinas cursadas classificar a listagem pelo nome do aluno
codigoid nome cursoedscritivo valor_mensalidadeR$000,00

SELECT d.id_disciplina 'Código',
a.nome 'Nome',
c.descritivo 'Curso',
CONCAT("R$",FORMAT(SUM(valor),2,"de_DE")) 'Valor_mensalidade'
FROM disciplinas d INNER JOIN cursos c
ON(d.id_curso=c.id_curso)
INNER JOIN matriculas m
ON(m.id_disciplina=d.id_disciplina)
INNER JOIN alunos a
ON(a.id_aluno=m.id_aluno)
GROUP BY a.id_aluno
ORDER BY a.nome #######melhorar a logica/relacionamentos, alunos cursos idcurso- disciplina iddisciplina- matricula idaluno
##ex5 - calcular a receita da clinica dos atendimentos considerando o valor da consulta padrao 250 reais

SELECT CONCAT("R$", FORMAT(COUNT(id_atendimento) * 250, 2)) "Receita da clínica"
FROM atendimentos

#ex6 achar o examas com maior valor
SELECT MAX(valor)
FROM exames

#ex7 achar o exame com menor valor

SELECT MIN(valor)
FROM exames

#ex8 achar o exame com o maior e menor valor
SELECT MAX(valor) "maior", MIN(valor) "menor"
FROM exames

## ex1 - Contar o numero de alunos do sexo masculino faculdade
SELECT	COUNT(id_aluno) "Quantidade TOTAL de alunos: "
FROM alunos
WHERE sexo = "M"

##ex2 - calcular a receita da faculdade. a receita da faculdade é a soma dos valores de todas as disciplinas que estao sendo cursadas
SELECT CONCAT("R$",FORMAT(SUM(valor), 2,"de_de")) "Receita"
FROM disciplinas d INNER JOIN matriculas m
ON(d.id_disciplina=m.id_disciplina)

##ex3 - calcular a receita de cada curso da faculdade
SELECT c.id_curso "Código",
	c.descritivo "Descritivo" ,
	SUM(d.valor) "Valor"
FROM disciplinas d INNER JOIN matriculas m
ON (d.id_disciplina=m.id_disciplina)
INNER JOIN cursos c ON(c.id_curso=d.id_curso) #sempre agrupar por ID
GROUP BY c.id_curso
ORDER BY SUM(d.valor) DESC
LIMIT 1

sempre agrupar por id
HAVING 'Nmero_alunos' >= 6  tem q ser variavel  sem espaço acento 
HAVING COUNT(a.id_curso) >= 6 sem ser variavel	com "      "
tipo where sem ser where, faz depois q a tabela ta pronta

#ex1 - Calcular o numero de alunos do sexo feminino em cada curso. classificar a listagem em ordem alfabetica
codigoid cursodescritivo nmeroalunos00
SELECT COUNT(a.id_curso) 'Nmero_alunos',
c.descritivo 'Curso',
c.id_curso 'Código'
FROM alunos a INNER JOIN cursos c
ON(a.id_curso=c.id_curso)
WHERE sexo = 'F'
GROUP BY c.id_curso 
ORDER BY c.descritivo

#ex2 - calcular o numero de disciplinas ministradas por cada professor classificar a listagem e ordem alfabetica pelo nome do professor
codigoid professornome cursodescritivo nro_disciplina00

SELECT p.id_professor 'Código',
p.nome 'Professor',
c.descritivo 'Curso',
COUNT(d.id_professor) 'Nro_disciplina'
FROM professores p INNER JOIN  cursos c
ON(p.id_curso=c.id_curso)
INNER JOIN disciplinas d 
ON(d.id_professor=p.id_professor)
GROUP BY p.id_professor
ORDER BY p.nome


#ex3 - calcular o numero de alunos matriculos em cada disciplina 
codigoid disciplinadescritivo cursodescritivo nro_alunos00

SELECT d.id_disciplina 'Código',
d.descritivo 'Disciplina',
c.descritivo 'Curso',
COUNT(m.id_disciplina) 'Nro_alunos'
FROM matriculas m INNER JOIN disciplinas d 
ON(m.id_disciplina=d.id_disciplina)
INNER JOIN cursos c
ON(d.id_curso=c.id_curso)
GROUP BY d.id_disciplina